<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WxCC Flow Visualizer v3</title>
    <meta name="app-version-html" content="v3.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="loadingOverlay" class="d-none">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
        <div class="mt-2 fw-bold text-secondary">Rendering High-Fidelity Flow...</div>
    </div>

    <div class="d-flex h-100 w-100 position-relative">
        
        <div class="controls-layer">
            <h6 class="mb-3"><i class="fa-solid fa-diagram-project me-2"></i>Flow Visualizer v3</h6>
            
            <div class="mb-2">
                <input type="file" id="fileInput" class="form-control form-control-sm" accept=".json">
            </div>

            <div class="d-flex gap-2 mb-3">
                <button id="btnProcess" class="btn btn-primary btn-sm flex-grow-1" disabled>Visualize</button>
                <button id="btnFit" class="btn btn-secondary btn-sm" disabled>Fit</button>
            </div>

            <div id="flowInfo" class="d-none">
                <small class="text-muted d-block">Current Flow:</small>
                <strong id="flowName" class="d-block mb-2 text-dark text-truncate"></strong>
                <button id="btnPdf" class="btn btn-danger w-100 btn-sm"><i class="fa-solid fa-file-pdf me-2"></i>Export PDF</button>
            </div>
            
            <div id="errorMsg" class="alert alert-warning mt-2 d-none small"></div>
        </div>

        <div id="cy" class="flex-grow-1"></div>

        <div class="offcanvas offcanvas-end" tabindex="-1" id="detailsPanel" data-bs-backdrop="false">
            <div class="offcanvas-header bg-light border-bottom">
                <h5 class="offcanvas-title" id="detailsTitle">Node Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body font-monospace small bg-white">
                <pre id="detailsContent" class="p-2 border rounded bg-light" style="white-space: pre-wrap; word-break: break-all;">Select a node to view details.</pre>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-node-html-label@1.2.2/dist/cytoscape-node-html-label.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
