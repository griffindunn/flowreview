<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WxCC Flow Visualizer v5.1</title>
    <meta name="app-version-html" content="v5.1">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css?v=5.1">
</head>
<body>

    <div id="loadingOverlay" class="d-none">
        <div class="spinner-border text-secondary" role="status"></div>
        <div class="mt-2 small text-muted font-monospace">Rendering Flow v5.1...</div>
    </div>

    <div class="controls-layer p-3 rounded shadow-sm border bg-white">
        <h6 class="fw-bold mb-3"><i class="fa-solid fa-code-branch me-2"></i>Flow Visualizer</h6>
        
        <div class="mb-3">
            <input type="file" id="fileInput" class="form-control form-control-sm" accept=".json">
        </div>

        <div class="d-flex gap-2 mb-2">
            <button id="btnProcess" class="btn btn-primary btn-sm flex-grow-1" disabled>Visualize</button>
            <button id="btnFit" class="btn btn-outline-secondary btn-sm" disabled><i class="fa-solid fa-compress"></i> Fit</button>
        </div>

        <div id="flowInfo" class="d-none mt-3 border-top pt-2">
            <div class="text-xs text-uppercase text-muted fw-bold mb-1">Active Flow</div>
            <div id="flowName" class="text-truncate fw-bold small mb-2"></div>
            <button id="btnPdf" class="btn btn-danger w-100 btn-sm"><i class="fa-solid fa-file-pdf"></i> Export PDF</button>
        </div>
        
        <div id="errorMsg" class="alert alert-danger mt-2 d-none py-1 px-2 small"></div>
    </div>

    <div id="cy"></div>

    <div class="offcanvas offcanvas-end shadow" tabindex="-1" id="detailsPanel" data-bs-backdrop="false">
        <div class="offcanvas-header border-bottom bg-light py-2">
            <h6 class="offcanvas-title m-0" id="detailsTitle"><i class="fa-solid fa-circle-info me-2"></i>Node Configuration</h6>
            <button type="button" class="btn-close btn-sm" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body p-0 bg-light">
            <div class="p-3">
                <pre id="detailsContent" class="bg-white border rounded p-3 small mb-0 shadow-sm" style="font-size: 11px;"></pre>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-node-html-label@1.2.2/dist/cytoscape-node-html-label.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="app.js?v=5.1"></script>
</body>
</html>
